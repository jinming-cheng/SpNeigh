<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Identify cells located within spatial boundaries or ring regions — GetCellsInside • SpNeigh</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify cells located within spatial boundaries or ring regions — GetCellsInside"><meta name="description" content="Returns the subset of cells from the input data that fall spatially
within a given boundary or ring.
The boundary can be provided either as raw boundary points
(from GetBoundary()), as polygons (from BuildBoundaryPoly()),
or as ring regions (from GetRingRegion()).
The function uses spatial point-in-polygon matching via sf::st_within."><meta property="og:description" content="Returns the subset of cells from the input data that fall spatially
within a given boundary or ring.
The boundary can be provided either as raw boundary points
(from GetBoundary()), as polygons (from BuildBoundaryPoly()),
or as ring regions (from GetRingRegion()).
The function uses spatial point-in-polygon matching via sf::st_within."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SpNeigh</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SpNeigh.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/jinming-cheng/SpNeigh/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Identify cells located within spatial boundaries or ring regions</h1>
      <small class="dont-index">Source: <a href="https://github.com/jinming-cheng/SpNeigh/blob/main/R/GetCellsInside.R"><code>R/GetCellsInside.R</code></a></small>
      <div class="d-none name"><code>GetCellsInside.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns the subset of cells from the input data that fall spatially
within a given boundary or ring.
The boundary can be provided either as raw boundary points
(from <code><a href="GetBoundary.html">GetBoundary()</a></code>), as polygons (from <code><a href="BuildBoundaryPoly.html">BuildBoundaryPoly()</a></code>),
or as ring regions (from <code><a href="GetRingRegion.html">GetRingRegion()</a></code>).
The function uses spatial point-in-polygon matching via <code><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html" class="external-link">sf::st_within</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">GetCellsInside</span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NULL</span>, boundary <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A Seurat object or a data frame with
columns: <code>x</code>, <code>y</code>, <code>cell</code>, and <code>cluster</code>.
If a Seurat object is provided, the <code>seurat_clusters</code>
metadata column will be used as the <code>cluster</code>.</p></dd>


<dt id="arg-boundary">boundary<a class="anchor" aria-label="anchor" href="#arg-boundary"></a></dt>
<dd><p>An <code>sf</code> object (polygon or ring) or a data frame
of boundary points returned by <code><a href="GetBoundary.html">GetBoundary()</a></code>,
<code><a href="BuildBoundaryPoly.html">BuildBoundaryPoly()</a></code>, or <code><a href="GetRingRegion.html">GetRingRegion()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame (tibble) of cells located inside the
given spatial region(s), with region assignment in
a <code>region_id</code> column.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load coordinates</span></span></span>
<span class="r-in"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"MouseBrainCoords.rds"</span>,</span></span>
<span class="r-in"><span>    package <span class="op">=</span> <span class="st">"SpNeigh"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          x        y cell cluster</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1898.815 2540.963    1       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1895.305 2532.627    2       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2368.073 2534.409    3       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1903.726 2560.010    4       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1917.481 2543.132    5       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1926.540 2560.044    6       4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get cells inside boundaries</span></span></span>
<span class="r-in"><span><span class="va">boundary_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="GetBoundary.html">GetBoundary</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">coords</span>, one_cluster <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    eps <span class="op">=</span> <span class="fl">120</span>, minPts <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cells_inside</span> <span class="op">&lt;-</span> <span class="fu">GetCellsInside</span><span class="op">(</span>data <span class="op">=</span> <span class="va">coords</span>, boundary <span class="op">=</span> <span class="va">boundary_points</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cells_inside</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 5073 features and 3 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POINT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 1590.613 ymin: 1640.136 xmax: 5443.607 ymax: 3531.379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CRS:           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> First 10 features:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    cell cluster region_id                  geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3       2         1 POINT (2368.073 2534.409)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   20       2         1 POINT (2456.959 2560.494)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31   31       2         1 POINT (2152.998 2554.538)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43   43       2         1 POINT (2312.183 2555.867)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44   44       2         1  POINT (2323.21 2551.805)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50   50       2         1 POINT (2356.391 2544.839)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52   52       2         1 POINT (2387.844 2537.827)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53   53       2         1 POINT (2401.216 2526.458)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54   54       2         1 POINT (2392.535 2555.696)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55   55       2         1 POINT (2407.538 2545.443)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get cells inside rings</span></span></span>
<span class="r-in"><span><span class="va">ring_regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="GetRingRegion.html">GetRingRegion</a></span><span class="op">(</span>boundary <span class="op">=</span> <span class="va">boundary_points</span>, dist <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cells_ring</span> <span class="op">&lt;-</span> <span class="fu">GetCellsInside</span><span class="op">(</span>data <span class="op">=</span> <span class="va">coords</span>, boundary <span class="op">=</span> <span class="va">ring_regions</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cells_ring</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 4362 features and 3 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POINT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 1482.997 ymin: 1530.545 xmax: 5441.679 ymax: 3532.463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CRS:           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> First 10 features:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    cell cluster region_id                  geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21   21       4         1 POINT (2080.017 2559.984)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   22       4         1 POINT (2088.025 2526.528)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23   23       2         1 POINT (2085.119 2546.843)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24   24       2         1 POINT (2101.906 2549.501)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25   25       4         1 POINT (2102.112 2540.185)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26   26       4         1 POINT (2089.812 2539.796)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27   27       4         1  POINT (2095.253 2533.08)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28   28       4         1  POINT (2100.02 2527.252)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29   29       4         1 POINT (2197.507 2524.511)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30   30       3         1 POINT (2209.931 2542.314)</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jinming Cheng.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

