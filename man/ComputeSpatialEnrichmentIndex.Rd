% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ComputeSpatialEnrichmentIndex.R
\name{ComputeSpatialEnrichmentIndex}
\alias{ComputeSpatialEnrichmentIndex}
\title{Compute spatial enrichment index (SEI) for each gene}
\usage{
ComputeSpatialEnrichmentIndex(exp_mat, weights)
}
\arguments{
\item{exp_mat}{A gene expression matrix (genes Ã— cells), either of class \code{matrix} or \code{dgCMatrix}.}

\item{weights}{A numeric vector of spatial weights, same length as the number of cells.}
}
\value{
A data frame with columns:
\itemize{
\item \code{gene}: gene name
\item \code{SEI}: spatial enrichment index (weighted mean expression)
\item \code{mean_expr}: mean expression across all cells
\item \code{normalized_SEI}: ratio of SEI to mean expression
}
Sorted by \code{normalized_SEI} from high to low.
}
\description{
Computes a spatial enrichment index (SEI) for each gene using precomputed spatial weights.
This generalizes to any distance-based weighting scheme (e.g. boundary, centroid, or other).
}
\examples{

# Load coordinates of cells in mouse brain
coords <- readRDS(system.file("extdata", "MouseBrainCoords.rds",
                              package = "SpNeigh"))
head(coords)

# Load log normalized expression data of mouse brain,
# only cells in cluster 0 and cluster 6 are included
logNorm_expr <- readRDS(system.file("extdata", "LogNormExpr.rds",
                              package = "SpNeigh"))
class(logNorm_expr)

# Compute boundary weights for cluster 0 cells
bon_c0 <- GetBoundary(data = coords, one_cluster = 0)
cells_c0 <- subset(coords, cluster==0)[,"cell"]
weights_bon <- ComputeBoundaryWeights(data = coords,
                                      cell_ids = cells_c0,
                                      boundary = bon_c0)

# Compute spatial enrichment index for boundaries
library(Matrix)
df_sei <- ComputeSpatialEnrichmentIndex(exp_mat = logNorm_expr[,cells_c0],
                                        weights = weights_bon)
head(df_sei)

}
