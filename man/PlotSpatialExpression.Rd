% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PlotExpression.R
\name{PlotSpatialExpression}
\alias{PlotSpatialExpression}
\title{Plot average gene expression along spatial distance}
\usage{
PlotSpatialExpression(
  exp_mat = NULL,
  spatial_distance = NULL,
  genes = NULL,
  n_bins = 50,
  n_labels = 6,
  row_gap = 0,
  column_gap = 0,
  label_x = "Spatial distance",
  label_y = "Gene",
  theme_ggplot = my_theme_ggplot()
)
}
\arguments{
\item{exp_mat}{A gene expression matrix (genes x cells) of class \code{matrix} or \code{dgCMatrix}.
If \code{data} is a Seurat object, the matrix will be extracted automatically using \code{Seurat::GetAssayData()}.}

\item{spatial_distance}{A named numeric vector containing the spatial distance (or weights) for each cell.
Must be the same length as \code{cell_ids}. Scaled distances are recommended.}

\item{genes}{Character vector specifying gene names to be plotted. Must match row names in \code{exp_mat}.}

\item{n_bins}{Integer. Number of bins to divide the spatial distance into. Default is 50.}

\item{n_labels}{Integer. Number of axis labels to show along the distance axis. Default is 6.}

\item{row_gap}{Numeric between 0 (inclusive) and 1 (exclusive). Gap between rows (genes) in the plot. Default is 0.}

\item{column_gap}{Numeric between 0 (inclusive) and 1 (exclusive). Gap between columns (distance bins) in the plot. Default is 0.}

\item{label_x}{Character. Label for the x-axis. Default is "Spatial distance".}

\item{label_y}{Character. Label for the y-axis. Default is "Gene".}

\item{theme_ggplot}{A ggplot2 theme object. Default is \code{my_theme_ggplot()}.}
}
\value{
A ggplot2 object displaying a heatmap of binned average gene expression across spatial distances.
}
\description{
Visualizes how the average expression of specified genes varies along a spatial distance gradient.
The spatial distance is binned, and the average expression within each bin is plotted as a heatmap.
}
\examples{
# Example spatial expression heatmap
set.seed(1)
exp_mat <- matrix(runif(1000), nrow = 10)
rownames(exp_mat) <- paste0("Gene", 1:10)
spatial_distance <- runif(100)
PlotSpatialExpression(exp_mat = exp_mat,
                      spatial_distance = spatial_distance,
                      genes = rownames(exp_mat)[1:5])

}
