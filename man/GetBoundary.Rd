% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GetBoundary.R
\name{GetBoundary}
\alias{GetBoundary}
\title{Extract spatial boundary points for a cluster or cell population}
\usage{
GetBoundary(
  data = NULL,
  one_cluster = NULL,
  k = 5,
  distance_cutoff = 30,
  multi_region = TRUE,
  subregion_method = c("dbscan", "kmeans"),
  eps = 80,
  minPts = 10,
  n_subregions = 3
)
}
\arguments{
\item{data}{A Seurat object or a data frame with
columns: \code{x}, \code{y}, \code{cell}, and \code{cluster}.
If a Seurat object is provided, the \code{seurat_clusters}
metadata column will be used as the \code{cluster}.}

\item{one_cluster}{The cluster ID (numeric or character) to extract
the boundary for.}

\item{k}{The number of nearest neighbors to use for computing
local distances. Default is 5.}

\item{distance_cutoff}{A numeric threshold on the average distance
to neighbors. Cells with a higher mean distance
will be removed. Default is 30.}

\item{multi_region}{Logical. If \code{TRUE}, identifies multiple spatial
subregions within the cluster. Default is \code{TRUE}.}

\item{subregion_method}{Subregion detection method when
\code{multi_region = TRUE}. Choose from "dbscan" (automatic)
or "kmeans" (manual). Default is "dbscan".}

\item{eps}{Neighborhood radius for \code{DBSCAN} subregion detection.
Only used if \code{subregion_method = "dbscan"}.
Default is 80.}

\item{minPts}{Minimum number of points for \code{DBSCAN} core point.
Only used if \code{subregion_method = "dbscan"}.
Default is 10.}

\item{n_subregions}{Number of subregions to use if
\code{subregion_method = "kmeans"}. Default is 3.}
}
\value{
A data frame containing boundary points with
columns \code{x}, \code{y}, and \code{region_id}.
If \code{multi_region = TRUE}, multiple boundaries are returned
and labeled by \code{region_id}.
Otherwise, a single boundary is returned with \code{region_id = 1}.
}
\description{
Identifies and returns smoothed spatial boundary points for a specified
cell cluster or population using a concave hull algorithm.
The function supports both single-region and multi-region boundaries.
In multi-region mode, subregions can be detected automatically via
DBSCAN or manually using k-means clustering.
Outlier cells are first removed using a k-nearest neighbor distance
filter to ensure boundary smoothness.
}
\examples{
# Load coordinates
coords <- readRDS(system.file("extdata", "MouseBrainCoords.rds",
    package = "SpNeigh"
))
head(coords)

# Get boundary points of cluster 1
boundary_points <- GetBoundary(data = coords, one_cluster = 1)
head(boundary_points)

# Number of subregions
table(boundary_points$region_id)

# Get boundary points of cluster 1 using kmeans method
# and manually specify subregion number
boundary_points <- GetBoundary(
    data = coords,
    one_cluster = 1,
    subregion_method = "kmeans",
    n_subregions = 2
)
table(boundary_points$region_id)

# Get boundary points of cluster 1 without multiple regions
boundary_points <- GetBoundary(
    data = coords,
    one_cluster = 1,
    multi_region = FALSE
)
table(boundary_points$region_id)

}
